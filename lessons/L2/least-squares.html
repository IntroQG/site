

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Least squares regressions &mdash; IntroQG 2019 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'2019',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-92357604-2"></script>
        <script type="text/javascript" src="../../_static/google_analytics_tracker.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> IntroQG
          

          
            
            <img src="../../_static/HY-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2019
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/course-details.html">Course details</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/course-details.html#course-meetings">Course meetings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/course-details.html#instructors">Instructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/course-details.html#course-website">Course website</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/course-details.html#textbooks">Textbooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/grading.html">Grading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/grading.html#general-grading-breakdown">General grading breakdown</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/licensing.html">Content licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IntroQG</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Least squares regressions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/IntroQG/site/blob/master/source/lessons/L2/least-squares.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  






<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="least-squares-regressions">
<h1>Least squares regressions<a class="headerlink" href="#least-squares-regressions" title="Permalink to this headline">¶</a></h1>
<p><em>Least squares regressions</em> are a common way of determining whether two values are <em>linearly</em> related to one an other.
In other words, this is a method to determine whether a line is a good “fit” to some measured values.
Not all data should be expected to be fit well by a line, but linear regressions are a powerful method for determining cases when two variables are directly related to one another.
A common example might be the temperature at which magma erupts versus the SiO<sub>2</sub> content of the magma, as shown below in Figure 2.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../../_images/magma-temps.png"><img alt="Magma temperatures" src="../../_images/magma-temps.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 2. Eruption temperatures of magmas as a function of their SiO<sub>2</sub> content with a linear regression line.
Source: Figure 16.1 from <a class="reference external" href="http://www.cambridge.org/fi/academic/subjects/earth-and-environmental-science/earth-science-general-interest/geostatistics-explained-introductory-guide-earth-scientists?format=HB&amp;isbn=9780521763226">McKillup and Dyar, 2010</a>.</span></p>
</div>
<p>The general idea with calculating a <em>linear regression</em> is that we want to find the equation of a line that best fits some <em>x-y</em> data, such as temperature and SiO<sub>2</sub> content in the example above.
To do this, we first need to recall the equation for a line:</p>
<div class="math notranslate nohighlight">
\[y = A + B x\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are the coordinates of the data points, <span class="math notranslate nohighlight">\(A\)</span> is the <span class="math notranslate nohighlight">\(y\)</span>-intercept, and <span class="math notranslate nohighlight">\(B\)</span> is the slope of the line.</p>
<p>Thus, in order to calculate a “best fit” line to some data, we will need to determine the values of the constants <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>.
Consider the example below in which <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are known.
If we make the rather common assumption that the uncertainties for the values on the <span class="math notranslate nohighlight">\(x\)</span> axis are negligible compared to the uncertainties along the <span class="math notranslate nohighlight">\(y\)</span> axis, we can say:</p>
<div class="math notranslate nohighlight">
\[(\mathrm{true~value~of~}y_{i}) = A + B x_{i}\]</div>
<p>Thus, it is possible to find the value of <span class="math notranslate nohighlight">\(y\)</span> for two linearly related values when <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are known.</p>
<p>Finding the values of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> then for the case of a linear regression to some <em>x-y</em> data is fairly straightforward, though it does involve a bit of algebra.
For our purposes, I’ll refer you to Chapter 8 of <a class="reference external" href="http://www.uscibooks.com/taylornb.htm">Taylor, 1997</a> for a complete derivation of how to find <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, and simply present the relevant equations below.
The value of the <span class="math notranslate nohighlight">\(y\)</span> intercept can be found using:</p>
<div class="math notranslate nohighlight">
\[A = \frac{\sum{x^{2}} \sum{y} - \sum{x} \sum{xy}}{\Delta}\]</div>
<p><span class="math notranslate nohighlight">\(x\)</span> is <span class="math notranslate nohighlight">\(i\)</span>th data point plotted on the <span class="math notranslate nohighlight">\(x\)</span>-axis, <span class="math notranslate nohighlight">\(y\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>th data point plotted on the <span class="math notranslate nohighlight">\(y\)</span>-axis, and <span class="math notranslate nohighlight">\(\Delta\)</span> is defined below.</p>
<p>The line slope can be found using:</p>
<div class="math notranslate nohighlight">
\[B = \frac{N \sum{xy} - \sum{x} \sum {y}}{\Delta}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of values in the regression.</p>
<p>And the value of <span class="math notranslate nohighlight">\(\Delta\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\Delta = N \sum{x^{2}} - \left( \sum{x} \right)^{2}\]</div>
<p>With the equations above, you are now able to calculate <em>unweighted</em> regression lines, the best-fit lines to some <em>x-y</em> data in which the uncertainties in the measurements are not considered to influence the fit of the line.
It is also possible to fit regression lines that consider the variable uncertainties in the data, referred to as <em>weighted regressions</em>, but will will not consider that type of regression for the time being.</p>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, D. Whipp, Department of Geosciences and Geography, University of Helsinki.
      <span class="lastupdated">
        Last updated on Nov 08, 2018.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p><br/><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /></a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: master
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../2017/index.html">2017</a></dd>
            <dd><a href="../../2018/lessons/L2/least-squares.html">2018</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../develop/lessons/L2/least-squares.html">develop</a></dd>
            <dd><a href="../../master/lessons/L2/least-squares.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>